{# Overlay container #}
<div
  x-cloak
  x-show="contactModal"
  class="z-40 fixed inset-0 overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true"
>
  <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:p-0">

    <div 
      @click="contactModal = false"
      class="fixed inset-0 bg-alf-white bg-opacity-75 transition-opacity" aria-hidden="true"
    >
    </div>

    <!-- This element is to trick the browser into centering the modal contents. -->
    <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
    
    {# Enquiry modal container #}
    <div class="relative z-30 inline-block self-center bg-white rounded-lg text-left overflow-hidden shadow-xl align-middle sm:max-w-xl md:max-w-3xl lg:max-w-4xl xl:max-w-5xl w-full">
      
      {# Close button #}
      <div 
        @click="contactModal = false"
        class="block absolute top-0 right-0 pt-4 pr-4"
      >
        <button type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center hover:text-slt-blue">
          <span class="sr-only">Close</span>

          <!-- Heroicon name: outline/x -->
          <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>

        </button>
      </div>
      {# End | Close button #}

      <div class="grid md:grid-cols-12">
      
        
        
        {# Inputs container #}
        <div class="bg-alf-white py-4 px-12 text-center md:col-span-6">

          {# Heading #}
          <div class="mt-8 font-rubik font-semibold text-left text-2xl md:text-3xl uppercase">Request a Partnership</div>

          {# Paragraph #}
          <div class="mt-8 font-rubik text-left text-xl">If you want to get involved via any of the above mentioned
          avenues or in other ways please reach out to us.
          </div>

          {# Enquiry form #}
          <div class="pt-10 mx-auto">
            
            <style>
              .required::after {
                content: "*";
                color: #d00;
                margin-left: 5px;
              }
            </style>
            
            {# Debug script for production AJAX issues #}
            <script>
              document.addEventListener('DOMContentLoaded', function() {
                // Add debugging for Freeform AJAX requests
                const originalFetch = window.fetch;
                window.fetch = function(...args) {
                  console.log('Freeform AJAX Request:', args);
                  return originalFetch.apply(this, args)
                    .then(response => {
                      console.log('Freeform AJAX Response:', response.status, response.statusText);
                      if (!response.ok) {
                        console.error('Freeform AJAX Error:', response.status, response.statusText);
                      }
                      return response;
                    })
                    .catch(error => {
                      console.error('Freeform AJAX Network Error:', error);
                      throw error;
                    });
                };
                
                // Add event listeners for Freeform events
                document.addEventListener('freeform-ajax-success', function(event) {
                  console.log('Freeform AJAX Success:', event.detail);
                });
                
                document.addEventListener('freeform-ajax-error', function(event) {
                  console.error('Freeform AJAX Error:', event.detail);
                  // Show user-friendly error message
                  alert('There was an error submitting the form. Please try refreshing the page and submitting again.');
                });
                
                document.addEventListener('freeform-ajax-after-submit', function(event) {
                  console.log('Freeform AJAX After Submit:', event.detail);
                });
              });
            </script>
              
            {{ craft.freeform.form("contactForm", {
              attributes: {
                class: "w-full",
                row: {
                  class: "flex flex-wrap -mx-3"
                }
              },
              buttons: {
                attributes: {
                  submit: { class: "bg-alf-nav-blue hover:underline text-alf-white py-3 px-10 rounded" }
                }
              },
              fields: {
                "@global": {
                  attributes: {
                    container: { class: "w-full px-3 pb-6 md:mb-0" },
                    input: { class: "appearance-none block w-full bg-white text-gray-700 border-2 border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500" },
                    label: { class: "tracking-wide text-gray-700 text-xs font-bold mb-2 block text-left" }
                  }
                },
                ":required": {
                  attributes: {
                    label: { "+class": " required" }
                  }
                },
                ":errors": {
                  attributes: {
                    input: { "+class": " border-alf-red" }
                  }
                },
                "@select": {
                  attributes: {
                    input: { "=class": "block appearance-none w-full bg-white border-2 border-gray-200 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500" }
                  }
                },
                "@textarea": {
                  attributes: {
                    input: { "=class": "appearance-none block w-full bg-white text-gray-700 border-2 border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500" }
                  }
                }
              }
            }).render() }}

          </div>
            
        </div>
        {# End | Inputs container #} 

         {# Illustration container #}
          {% set image = base.modalImage.one() %}
        <div class="bg-alf-blue hidden md:flex items-center justify-center md:col-span-6">

          <img src="{{ image.url }}" class="h-full w-auto p-4" alt="{{ image.alt }}">
            
        </div>
        {# End | Illustration container #}   

      </div>

    </div>
    {# End | Enquiry modal container #}

  </div>

</div>
{# End | Overlay container #}